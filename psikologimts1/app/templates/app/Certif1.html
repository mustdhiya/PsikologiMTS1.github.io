{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Educational Certificate Automation System</title>
    <link rel="stylesheet" href="{% static 'app/tailwindcss.js' %}" />
    <script src="{% static 'app/chart.js' %}"></script>
    <link rel="icon" type="image/x-icon" href="logo.png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet" />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #f0f4f8;
      }
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
      .certificate {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cpath fill='%23f0f0f0' d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z'/%3E%3C/svg%3E");
        border: 2px solid #ddd;
        position: relative;
      }
      .certificate::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border: 1px solid #e2e8f0;
        pointer-events: none;
      }
      .school-logo {
        width: 80px;
        height: 80px;
      }
      .qr-code {
        width: 100px;
        height: 100px;
      }
      .signature {
        height: 60px;
        margin-top: 10px;
      }
      .workflow-arrow {
        position: relative;
        height: 2px;
        background-color: #3b82f6;
        margin: 0 10px;
      }
      .workflow-arrow::after {
        content: "";
        position: absolute;
        right: -5px;
        top: -4px;
        width: 0;
        height: 0;
        border-left: 10px solid #3b82f6;
        border-top: 5px solid transparent;
        border-bottom: 5px solid transparent;
      }
    </style>
  </head>
  <body>
    <div class="container mx-auto px-4 py-8 max-w-6xl">
      <div
        class="bg-gradient-to-r from-blue-600 to-indigo-700 rounded-lg shadow-lg p-6 mb-8">
        <h1 class="text-3xl font-bold text-white text-center">
          Educational Certificate Automation System
        </h1>
        <p class="text-white text-center mt-2">
          Google Forms + Sheets + Autocrat Integration
        </p>
      </div>

      <!-- Tabs -->
      <div class="mb-6 bg-white rounded-lg shadow-md">
        <div class="flex border-b">
          <button
            id="tab-overview"
            class="tab-btn px-6 py-3 font-medium text-blue-600 border-b-2 border-blue-600">
            Overview
          </button>
          <button
            id="tab-form"
            class="tab-btn px-6 py-3 font-medium text-gray-500">
            Google Form
          </button>
          <button
            id="tab-sheet"
            class="tab-btn px-6 py-3 font-medium text-gray-500">
            Spreadsheet
          </button>
          <button
            id="tab-certificate"
            class="tab-btn px-6 py-3 font-medium text-gray-500">
            Certificate
          </button>
          <button
            id="tab-workflow"
            class="tab-btn px-6 py-3 font-medium text-gray-500">
            Workflow
          </button>
          <button
            id="tab-setup"
            class="tab-btn px-6 py-3 font-medium text-gray-500">
            Setup Guide
          </button>
        </div>

        <!-- Overview Tab -->
        <div id="content-overview" class="tab-content active p-6">
          <h2 class="text-2xl font-semibold mb-4">System Overview</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-blue-50 p-4 rounded-lg">
              <h3 class="text-lg font-medium text-blue-700 mb-2">
                Key Components
              </h3>
              <ul class="list-disc pl-5 space-y-2">
                <li>Google Form for grade submission</li>
                <li>Google Sheet for data storage and processing</li>
                <li>Autocrat add-on for certificate generation</li>
                <li>Google Slides for certificate template</li>
                <li>Automated email notification system</li>
              </ul>
            </div>
            <div class="bg-indigo-50 p-4 rounded-lg">
              <h3 class="text-lg font-medium text-indigo-700 mb-2">
                System Features
              </h3>
              <ul class="list-disc pl-5 space-y-2">
                <li>
                  Automatic certificate generation based on grade threshold
                </li>
                <li>QR code validation for certificates</li>
                <li>Email notifications to students and teachers</li>
                <li>Conditional formatting for grade tracking</li>
                <li>Secure data storage with access controls</li>
              </ul>
            </div>
          </div>

          <div class="mt-6 bg-white p-4 rounded-lg border border-gray-200">
            <h3 class="text-lg font-medium text-gray-800 mb-3">
              System Configuration
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >Minimum Grade for Certificate:</label
                >
                <input
                  type="number"
                  id="min-grade"
                  value="75"
                  min="0"
                  max="100"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >Categories of Achievement:</label
                >
                <input
                  type="text"
                  id="categories"
                  value="Academic, Arts, Sports, Leadership, Community Service"
                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" />
              </div>
            </div>
          </div>

          <div class="mt-6 flex justify-center">
            <button
              id="update-system"
              class="px-6 py-2 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 transition-colors">
              Update System Configuration
            </button>
          </div>
        </div>

        <!-- Google Form Tab -->
        <div id="content-form" class="tab-content p-6">
          <h2 class="text-2xl font-semibold mb-4">Google Form Setup</h2>
          <div class="bg-white border border-gray-200 rounded-lg shadow-sm">
            <div class="bg-blue-600 text-white p-4 rounded-t-lg">
              <h3 class="text-xl font-medium">Student Grade Submission Form</h3>
            </div>
            <div class="p-6">
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Full Name *</label
                  >
                  <input
                    type="text"
                    placeholder="Enter student's full name"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >NIS (Student ID) *</label
                  >
                  <input
                    type="text"
                    placeholder="Enter student ID number"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Class *</label
                  >
                  <select
                    class="w-full px-3 py-2 border border-gray-300 rounded-md">
                    <option value="">Select class</option>
                    <option value="10A">10A</option>
                    <option value="10B">10B</option>
                    <option value="11A">11A</option>
                    <option value="11B">11B</option>
                    <option value="12A">12A</option>
                    <option value="12B">12B</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Subject/Category *</label
                  >
                  <select
                    id="subject-dropdown"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md">
                    <option value="">Select subject/category</option>
                    <option value="Mathematics">Mathematics</option>
                    <option value="Science">Science</option>
                    <option value="Language Arts">Language Arts</option>
                    <option value="Social Studies">Social Studies</option>
                    <option value="Arts">Arts</option>
                    <option value="Sports">Sports</option>
                    <option value="Leadership">Leadership</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Grade *</label
                  >
                  <input
                    type="number"
                    min="0"
                    max="100"
                    placeholder="Enter grade (0-100)"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Student Email *</label
                  >
                  <input
                    type="email"
                    placeholder="student@school.edu"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Guardian Email</label
                  >
                  <input
                    type="email"
                    placeholder="guardian@example.com"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Additional Comments</label
                  >
                  <textarea
                    placeholder="Any additional information about the student's performance"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md"
                    rows="3"></textarea>
                </div>
                <div class="pt-4">
                  <button
                    class="px-6 py-2 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 transition-colors">
                    Submit Grade
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div
            class="mt-6 bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
            <h4 class="font-medium text-yellow-800">Form Configuration Tips</h4>
            <ul class="list-disc pl-5 mt-2 space-y-1 text-sm text-yellow-700">
              <li>Set all critical fields as "Required"</li>
              <li>Add data validation for grade (0-100)</li>
              <li>Enable email collection for form submitters</li>
              <li>Connect form to the grades spreadsheet</li>
              <li>Set up form notifications for administrators</li>
            </ul>
          </div>
        </div>

        <!-- Spreadsheet Tab -->
        <div id="content-sheet" class="tab-content p-6">
          <h2 class="text-2xl font-semibold mb-4">Spreadsheet Structure</h2>
          <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-200">
              <thead>
                <tr class="bg-gray-100">
                  <th class="px-4 py-2 border">A</th>
                  <th class="px-4 py-2 border">B</th>
                  <th class="px-4 py-2 border">C</th>
                  <th class="px-4 py-2 border">D</th>
                  <th class="px-4 py-2 border">E</th>
                  <th class="px-4 py-2 border">F</th>
                  <th class="px-4 py-2 border">G</th>
                  <th class="px-4 py-2 border">H</th>
                  <th class="px-4 py-2 border">I</th>
                </tr>
                <tr class="bg-blue-50">
                  <th class="px-4 py-2 border text-sm font-medium">
                    Timestamp
                  </th>
                  <th class="px-4 py-2 border text-sm font-medium">Email</th>
                  <th class="px-4 py-2 border text-sm font-medium">NIS</th>
                  <th class="px-4 py-2 border text-sm font-medium">Name</th>
                  <th class="px-4 py-2 border text-sm font-medium">Class</th>
                  <th class="px-4 py-2 border text-sm font-medium">Subject</th>
                  <th class="px-4 py-2 border text-sm font-medium">Grade</th>
                  <th class="px-4 py-2 border text-sm font-medium">Status</th>
                  <th class="px-4 py-2 border text-sm font-medium">
                    Certificate Link
                  </th>
                </tr>
              </thead>
              <tbody id="spreadsheet-body">
                <tr>
                  <td class="px-4 py-2 border text-sm">5/15/2023 10:23:45</td>
                  <td class="px-4 py-2 border text-sm">john.doe@school.edu</td>
                  <td class="px-4 py-2 border text-sm">2023001</td>
                  <td class="px-4 py-2 border text-sm">John Doe</td>
                  <td class="px-4 py-2 border text-sm">11A</td>
                  <td class="px-4 py-2 border text-sm">Mathematics</td>
                  <td class="px-4 py-2 border text-sm">85</td>
                  <td class="px-4 py-2 border text-sm bg-green-100">
                    Kirim Sertifikat
                  </td>
                  <td class="px-4 py-2 border text-sm text-blue-600 underline">
                    View Certificate
                  </td>
                </tr>
                <tr>
                  <td class="px-4 py-2 border text-sm">5/15/2023 11:05:12</td>
                  <td class="px-4 py-2 border text-sm">
                    jane.smith@school.edu
                  </td>
                  <td class="px-4 py-2 border text-sm">2023002</td>
                  <td class="px-4 py-2 border text-sm">Jane Smith</td>
                  <td class="px-4 py-2 border text-sm">11A</td>
                  <td class="px-4 py-2 border text-sm">Science</td>
                  <td class="px-4 py-2 border text-sm">92</td>
                  <td class="px-4 py-2 border text-sm bg-green-100">
                    Kirim Sertifikat
                  </td>
                  <td class="px-4 py-2 border text-sm text-blue-600 underline">
                    View Certificate
                  </td>
                </tr>
                <tr>
                  <td class="px-4 py-2 border text-sm">5/15/2023 13:45:30</td>
                  <td class="px-4 py-2 border text-sm">
                    mike.brown@school.edu
                  </td>
                  <td class="px-4 py-2 border text-sm">2023003</td>
                  <td class="px-4 py-2 border text-sm">Mike Brown</td>
                  <td class="px-4 py-2 border text-sm">10B</td>
                  <td class="px-4 py-2 border text-sm">Language Arts</td>
                  <td class="px-4 py-2 border text-sm">68</td>
                  <td class="px-4 py-2 border text-sm bg-red-100">Remedial</td>
                  <td class="px-4 py-2 border text-sm">-</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white p-4 rounded-lg border border-gray-200">
              <h3 class="text-lg font-medium text-gray-800 mb-3">
                Conditional Formatting
              </h3>
              <div class="bg-gray-50 p-3 rounded border border-gray-300">
                <code class="text-sm">
                  =IF(G2>=75, "Kirim Sertifikat", "Remedial")
                </code>
              </div>
              <p class="mt-2 text-sm text-gray-600">
                This formula automatically determines if a student qualifies for
                a certificate based on the minimum grade threshold.
              </p>
            </div>
            <div class="bg-white p-4 rounded-lg border border-gray-200">
              <h3 class="text-lg font-medium text-gray-800 mb-3">
                QR Code Generation
              </h3>
              <div class="bg-gray-50 p-3 rounded border border-gray-300">
                <code class="text-sm">
                  =IMAGE("https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl="&ENCODEURL(C2))
                </code>
              </div>
              <p class="mt-2 text-sm text-gray-600">
                This formula generates a QR code that links to the student's
                certificate validation page using their NIS.
              </p>
            </div>
          </div>

          <div class="mt-6 bg-blue-50 p-4 rounded-lg border border-blue-200">
            <h3 class="text-lg font-medium text-blue-800 mb-2">
              Additional Spreadsheet Features
            </h3>
            <ul class="list-disc pl-5 space-y-1 text-sm">
              <li>Protected ranges for admin-only access</li>
              <li>Data validation rules for grade entries</li>
              <li>Automated email triggers for remedial notifications</li>
              <li>Monthly summary statistics for counselors</li>
              <li>Audit log tracking for all grade changes</li>
            </ul>
          </div>
        </div>

        <!-- Certificate Tab -->
        <div id="content-certificate" class="tab-content p-6">
          <h2 class="text-2xl font-semibold mb-4">Certificate Template</h2>
          <div class="flex justify-center">
            <div
              class="certificate bg-white p-8 w-full max-w-2xl rounded-lg shadow-lg">
              <div class="flex justify-between items-center mb-6">
                <div
                  class="school-logo bg-blue-100 rounded-full p-2 flex items-center justify-center">
                  <svg
                    class="w-16 h-16 text-blue-600"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                  </svg>
                </div>
                <div class="text-right">
                  <p class="text-sm text-gray-600">
                    Certificate ID: CERT-2023-001
                  </p>
                  <p class="text-sm text-gray-600">
                    Date: <span id="cert-date">May 15, 2023</span>
                  </p>
                </div>
              </div>

              <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-blue-800 mb-1">
                  CERTIFICATE OF ACHIEVEMENT
                </h2>
                <div class="h-1 w-32 bg-blue-600 mx-auto"></div>
              </div>

              <div class="text-center mb-8">
                <p class="text-lg mb-1">This certifies that</p>
                <h3
                  class="text-2xl font-bold text-gray-800 mb-1"
                  id="cert-name">
                  John Doe
                </h3>
                <p class="text-lg mb-1">
                  Class: <span id="cert-class">11A</span>
                </p>
                <p class="text-lg">
                  Has achieved a grade of
                  <span class="font-bold text-blue-700" id="cert-grade"
                    >85</span
                  >
                  in
                </p>
                <h4
                  class="text-xl font-semibold text-gray-800 mt-1"
                  id="cert-subject">
                  Mathematics
                </h4>
              </div>

              <div class="flex justify-between items-end mt-10">
                <div class="text-center">
                  <div class="signature border-b border-gray-400 w-40">
                    <svg
                      class="w-full h-full text-gray-700 opacity-75"
                      viewBox="0 0 100 30"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M10,20 Q30,5 50,20 T90,20"
                        stroke="currentColor"
                        fill="none"
                        stroke-width="2" />
                    </svg>
                  </div>
                  <p class="text-sm font-medium mt-1">Subject Teacher</p>
                </div>
                <div class="qr-code bg-white border border-gray-200 p-1">
                  <svg
                    class="w-24 h-24"
                    viewBox="0 0 100 100"
                    xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="10" width="80" height="80" fill="white" />
                    <path
                      d="M20,20 h20 v20 h-20 z M25,25 h10 v10 h-10 z"
                      fill="black" />
                    <path
                      d="M60,20 h20 v20 h-20 z M65,25 h10 v10 h-10 z"
                      fill="black" />
                    <path
                      d="M20,60 h20 v20 h-20 z M25,65 h10 v10 h-10 z"
                      fill="black" />
                    <path d="M50,50 h10 v10 h-10 z" fill="black" />
                    <path d="M70,50 h10 v10 h-10 z" fill="black" />
                    <path d="M50,70 h10 v10 h-10 z" fill="black" />
                    <path d="M70,70 h10 v10 h-10 z" fill="black" />
                    <path d="M60,60 h5 v5 h-5 z" fill="black" />
                  </svg>
                  <p class="text-xs text-center mt-1">Scan to verify</p>
                </div>
                <div class="text-center">
                  <div class="signature border-b border-gray-400 w-40">
                    <svg
                      class="w-full h-full text-gray-700 opacity-75"
                      viewBox="0 0 100 30"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M10,15 Q20,5 30,15 Q40,25 50,15 Q60,5 70,15 Q80,25 90,15"
                        stroke="currentColor"
                        fill="none"
                        stroke-width="2" />
                    </svg>
                  </div>
                  <p class="text-sm font-medium mt-1">Principal</p>
                </div>
              </div>
            </div>
          </div>

          <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white p-4 rounded-lg border border-gray-200">
              <h3 class="text-lg font-medium text-gray-800 mb-3">
                Certificate Merge Tags
              </h3>
              <ul class="list-disc pl-5 space-y-1 text-sm">
                <li><code>{{Name}}</code> - Student's full name</li>
                <li><code>{{Class}}</code> - Student's class</li>
                <li><code>{{Subject}}</code> - Subject or category</li>
                <li><code>{{Grade}}</code> - Achieved grade</li>
                <li><code>{{Date}}</code> - Certificate issue date</li>
                <li><code>{{CertID}}</code> - Unique certificate ID</li>
                <li><code>{{QRCode}}</code> - Verification QR code</li>
              </ul>
            </div>
            <div class="bg-white p-4 rounded-lg border border-gray-200">
              <h3 class="text-lg font-medium text-gray-800 mb-3">
                Certificate Customization
              </h3>
              <div class="grid grid-cols-2 gap-3">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Student Name:</label
                  >
                  <input
                    type="text"
                    id="input-name"
                    value="John Doe"
                    class="w-full px-3 py-1 border border-gray-300 rounded-md text-sm" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Class:</label
                  >
                  <input
                    type="text"
                    id="input-class"
                    value="11A"
                    class="w-full px-3 py-1 border border-gray-300 rounded-md text-sm" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Subject:</label
                  >
                  <input
                    type="text"
                    id="input-subject"
                    value="Mathematics"
                    class="w-full px-3 py-1 border border-gray-300 rounded-md text-sm" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Grade:</label
                  >
                  <input
                    type="number"
                    id="input-grade"
                    value="85"
                    min="0"
                    max="100"
                    class="w-full px-3 py-1 border border-gray-300 rounded-md text-sm" />
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-1"
                    >Date:</label
                  >
                  <input
                    type="text"
                    id="input-date"
                    value="May 15, 2023"
                    class="w-full px-3 py-1 border border-gray-300 rounded-md text-sm" />
                </div>
                <div class="flex items-end">
                  <button
                    id="update-certificate"
                    class="px-4 py-1 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 transition-colors text-sm">
                    Update Preview
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Workflow Tab -->
        <div id="content-workflow" class="tab-content p-6">
          <h2 class="text-2xl font-semibold mb-4">Automation Workflow</h2>

          <div class="bg-white p-6 rounded-lg border border-gray-200 mb-6">
            <h3 class="text-lg font-medium text-gray-800 mb-4">
              Complete Process Flow
            </h3>

            <div class="flex flex-col space-y-6">
              <!-- Step 1 -->
              <div class="flex items-center">
                <div class="bg-blue-100 rounded-full p-3 flex-shrink-0">
                  <svg
                    class="w-6 h-6 text-blue-600"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                  </svg>
                </div>
                <div class="workflow-arrow flex-grow"></div>
                <div class="bg-blue-600 text-white rounded-lg p-3 flex-grow">
                  <h4 class="font-medium">1. Form Submission</h4>
                  <p class="text-sm text-blue-100">
                    Teacher submits student grade via Google Form
                  </p>
                </div>
              </div>

              <!-- Step 2 -->
              <div class="flex items-center">
                <div class="bg-blue-600 text-white rounded-lg p-3 flex-grow">
                  <h4 class="font-medium">2. Data Recording</h4>
                  <p class="text-sm text-blue-100">
                    Form responses are automatically recorded in Google Sheet
                  </p>
                </div>
                <div class="workflow-arrow flex-grow"></div>
                <div class="bg-blue-100 rounded-full p-3 flex-shrink-0">
                  <svg
                    class="w-6 h-6 text-blue-600"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                  </svg>
                </div>
              </div>

              <!-- Step 3 -->
              <div class="flex items-center">
                <div class="bg-blue-100 rounded-full p-3 flex-shrink-0">
                  <svg
                    class="w-6 h-6 text-blue-600"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                  </svg>
                </div>
                <div class="workflow-arrow flex-grow"></div>
                <div class="bg-blue-600 text-white rounded-lg p-3 flex-grow">
                  <h4 class="font-medium">3. Grade Evaluation</h4>
                  <p class="text-sm text-blue-100">
                    Conditional formatting checks if grade meets certificate
                    threshold
                  </p>
                </div>
              </div>

              <!-- Step 4 -->
              <div class="flex items-center">
                <div class="bg-blue-600 text-white rounded-lg p-3 flex-grow">
                  <h4 class="font-medium">4. Certificate Generation</h4>
                  <p class="text-sm text-blue-100">
                    Autocrat merges data into certificate template for
                    qualifying students
                  </p>
                </div>
                <div class="workflow-arrow flex-grow"></div>
                <div class="bg-blue-100 rounded-full p-3 flex-shrink-0">
                  <svg
                    class="w-6 h-6 text-blue-600"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                </div>
              </div>

              <!-- Step 5 -->
              <div class="flex items-center">
                <div class="bg-blue-100 rounded-full p-3 flex-shrink-0">
                  <svg
                    class="w-6 h-6 text-blue-600"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                  </svg>
                </div>
                <div class="workflow-arrow flex-grow"></div>
                <div class="bg-blue-600 text-white rounded-lg p-3 flex-grow">
                  <h4 class="font-medium">5. Notification Delivery</h4>
                  <p class="text-sm text-blue-100">
                    Automated emails sent to students, guardians, and teachers
                  </p>
                </div>
              </div>

              <!-- Step 6 -->
              <div class="flex items-center">
                <div class="bg-blue-600 text-white rounded-lg p-3 flex-grow">
                  <h4 class="font-medium">6. Certificate Archiving</h4>
                  <p class="text-sm text-blue-100">
                    PDF certificates saved to Google Drive with organized folder
                    structure
                  </p>
                </div>
                <div class="workflow-arrow flex-grow"></div>
                <div class="bg-blue-100 rounded-full p-3 flex-shrink-0">
                  <svg
                    class="w-6 h-6 text-blue-600"
                    xmlns="http://www.w3.org/2000/svg"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
                  </svg>
                </div>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white p-4 rounded-lg border border-gray-200">
              <h3 class="text-lg font-medium text-gray-800 mb-3">
                Autocrat Job Configuration
              </h3>
              <ol class="list-decimal pl-5 space-y-2 text-sm">
                <li>
                  Install Autocrat add-on from Google Workspace Marketplace
                </li>
                <li>Create a new merge job named "Student Certificates"</li>
                <li>Select the Google Slides certificate template</li>
                <li>Map spreadsheet columns to template merge tags</li>
                <li>Set output format to PDF</li>
                <li>
                  Configure dynamic file naming:
                  <code>Certificate_{{NIS}}_{{Subject}}</code>
                </li>
                <li>
                  Set up conditional processing:
                  <code>Status = "Kirim Sertifikat"</code>
                </li>
                <li>Configure email delivery with dynamic subject and body</li>
                <li>Set job to run automatically on form submission</li>
              </ol>
            </div>
            <div class="bg-white p-4 rounded-lg border border-gray-200">
              <h3 class="text-lg font-medium text-gray-800 mb-3">
                Email Notification Template
              </h3>
              <div
                class="bg-gray-50 p-3 rounded border border-gray-300 text-sm">
                <p>
                  <strong>Subject:</strong> Certificate of Achievement -
                  {{Subject}}
                </p>
                <hr class="my-2 border-gray-300" />
                <p>Dear {{Name}},</p>
                <p class="mt-2">
                  Congratulations on achieving a grade of {{Grade}} in
                  {{Subject}}!
                </p>
                <p class="mt-2">
                  We are pleased to attach your official certificate of
                  achievement. This certificate recognizes your hard work and
                  dedication to academic excellence.
                </p>
                <p class="mt-2">
                  You can verify the authenticity of this certificate by
                  scanning the QR code or visiting our certificate verification
                  portal at: https://school.edu/verify
                </p>
                <p class="mt-4">Best regards,<br />School Administration</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Setup Guide Tab -->
        <div id="content-setup" class="tab-content p-6">
          <h2 class="text-2xl font-semibold mb-4">Implementation Guide</h2>

          <div
            class="bg-white rounded-lg border border-gray-200 overflow-hidden mb-6">
            <div class="bg-blue-600 text-white p-3">
              <h3 class="text-lg font-medium">
                Step-by-Step Setup Instructions
              </h3>
            </div>
            <div class="p-4">
              <ol class="space-y-6">
                <li class="flex">
                  <div
                    class="bg-blue-100 rounded-full h-8 w-8 flex items-center justify-center mr-3 flex-shrink-0 mt-1">
                    <span class="text-blue-600 font-medium">1</span>
                  </div>
                  <div>
                    <h4 class="font-medium text-lg">Create Google Form</h4>
                    <p class="text-gray-600 mt-1">
                      Create a new Google Form with all required fields for
                      grade submission. Set up data validation rules for each
                      field (e.g., grade must be 0-100).
                    </p>
                    <div class="mt-2 flex space-x-2">
                      <a href="#" class="text-sm text-blue-600 hover:underline"
                        >View Form Template</a
                      >
                    </div>
                  </div>
                </li>

                <li class="flex">
                  <div
                    class="bg-blue-100 rounded-full h-8 w-8 flex items-center justify-center mr-3 flex-shrink-0 mt-1">
                    <span class="text-blue-600 font-medium">2</span>
                  </div>
                  <div>
                    <h4 class="font-medium text-lg">Set Up Google Sheet</h4>
                    <p class="text-gray-600 mt-1">
                      Connect the form to a new Google Sheet. Add additional
                      columns for Status and Certificate Link. Apply conditional
                      formatting to the Grade column to highlight values below
                      the minimum threshold.
                    </p>
                    <div
                      class="mt-2 bg-gray-50 p-2 rounded border border-gray-300">
                      <code class="text-sm">
                        =IF(G2>=75, "Kirim Sertifikat", "Remedial")
                      </code>
                    </div>
                  </div>
                </li>

                <li class="flex">
                  <div
                    class="bg-blue-100 rounded-full h-8 w-8 flex items-center justify-center mr-3 flex-shrink-0 mt-1">
                    <span class="text-blue-600 font-medium">3</span>
                  </div>
                  <div>
                    <h4 class="font-medium text-lg">
                      Create Certificate Template
                    </h4>
                    <p class="text-gray-600 mt-1">
                      Design a certificate template in Google Slides. Add merge
                      tags for dynamic content using double curly braces (e.g.,
                      {{Name}}).
                    </p>
                    <div class="mt-2 flex space-x-2">
                      <a href="#" class="text-sm text-blue-600 hover:underline"
                        >View Template Example</a
                      >
                    </div>
                  </div>
                </li>

                <li class="flex">
                  <div
                    class="bg-blue-100 rounded-full h-8 w-8 flex items-center justify-center mr-3 flex-shrink-0 mt-1">
                    <span class="text-blue-600 font-medium">4</span>
                  </div>
                  <div>
                    <h4 class="font-medium text-lg">
                      Install and Configure Autocrat
                    </h4>
                    <p class="text-gray-600 mt-1">
                      Install the Autocrat add-on from the Google Workspace
                      Marketplace. Create a new merge job that connects your
                      spreadsheet data to the certificate template.
                    </p>
                    <ul
                      class="list-disc pl-5 mt-2 text-sm text-gray-600 space-y-1">
                      <li>Set the job to run on form submission</li>
                      <li>
                        Configure conditional processing based on the Status
                        column
                      </li>
                      <li>Set up email delivery with dynamic content</li>
                      <li>
                        Configure file naming and storage location in Drive
                      </li>
                    </ul>
                  </div>
                </li>

                <li class="flex">
                  <div
                    class="bg-blue-100 rounded-full h-8 w-8 flex items-center justify-center mr-3 flex-shrink-0 mt-1">
                    <span class="text-blue-600 font-medium">5</span>
                  </div>
                  <div>
                    <h4 class="font-medium text-lg">
                      Set Up QR Code Validation
                    </h4>
                    <p class="text-gray-600 mt-1">
                      Create a QR code in your certificate that links to a
                      validation page. Use the Google Charts API to generate QR
                      codes dynamically.
                    </p>
                    <div
                      class="mt-2 bg-gray-50 p-2 rounded border border-gray-300">
                      <code class="text-sm">
                        =IMAGE("https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl="&ENCODEURL("https://school.edu/verify?id="&C2))
                      </code>
                    </div>
                  </div>
                </li>

                <li class="flex">
                  <div
                    class="bg-blue-100 rounded-full h-8 w-8 flex items-center justify-center mr-3 flex-shrink-0 mt-1">
                    <span class="text-blue-600 font-medium">6</span>
                  </div>
                  <div>
                    <h4 class="font-medium text-lg">Set Up Access Controls</h4>
                    <p class="text-gray-600 mt-1">
                      Configure sharing settings to restrict access to the
                      spreadsheet. Only administrators should have edit access,
                      while teachers may have view-only access.
                    </p>
                    <div
                      class="mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800">
                      <strong>Security Tip:</strong> Use Google Sheets'
                      protected ranges feature to prevent unauthorized editing
                      of critical columns.
                    </div>
                  </div>
                </li>

                <li class="flex">
                  <div
                    class="bg-blue-100 rounded-full h-8 w-8 flex items-center justify-center mr-3 flex-shrink-0 mt-1">
                    <span class="text-blue-600 font-medium">7</span>
                  </div>
                  <div>
                    <h4 class="font-medium text-lg">Test the System</h4>
                    <p class="text-gray-600 mt-1">
                      Submit test entries through the form to verify that the
                      entire workflow functions correctly. Check that
                      certificates are generated properly and emails are sent.
                    </p>
                    <div
                      class="mt-2 p-2 bg-blue-50 border border-blue-200 rounded text-sm text-blue-800">
                      <strong>Pro Tip:</strong> Create a separate test sheet
                      first to avoid sending test emails to actual students.
                    </div>
                  </div>
                </li>
              </ol>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white p-4 rounded-lg border border-gray-200">
              <h3 class="text-lg font-medium text-gray-800 mb-3">
                Troubleshooting Common Issues
              </h3>
              <div class="space-y-3">
                <div>
                  <h4 class="font-medium text-gray-700">
                    Certificates Not Generating
                  </h4>
                  <p class="text-sm text-gray-600">
                    Check that the Status column formula is working correctly
                    and that Autocrat's conditional processing is properly
                    configured.
                  </p>
                </div>
                <div>
                  <h4 class="font-medium text-gray-700">Emails Not Sending</h4>
                  <p class="text-sm text-gray-600">
                    Verify email addresses are correctly formatted and that you
                    haven't exceeded Google's daily email sending limits.
                  </p>
                </div>
                <div>
                  <h4 class="font-medium text-gray-700">
                    QR Codes Not Working
                  </h4>
                  <p class="text-sm text-gray-600">
                    Ensure the URL in the QR code is correctly formatted and
                    that the verification page is properly set up to receive the
                    student ID parameter.
                  </p>
                </div>
                <div>
                  <h4 class="font-medium text-gray-700">
                    Merge Tags Not Working
                  </h4>
                  <p class="text-sm text-gray-600">
                    Double-check that merge tags in the template exactly match
                    the column names in your spreadsheet (case-sensitive).
                  </p>
                </div>
              </div>
            </div>
            <div class="bg-white p-4 rounded-lg border border-gray-200">
              <h3 class="text-lg font-medium text-gray-800 mb-3">
                System Maintenance
              </h3>
              <ul class="list-disc pl-5 space-y-2 text-sm">
                <li>Schedule monthly backups of the spreadsheet data</li>
                <li>
                  Periodically check for Autocrat updates and new features
                </li>
                <li>
                  Review and clean up old certificate files in Google Drive
                </li>
                <li>Update the certificate template design annually</li>
                <li>Monitor storage usage in Google Drive</li>
                <li>Review access permissions quarterly</li>
                <li>Create an audit log of all system changes</li>
              </ul>
              <div
                class="mt-4 p-2 bg-green-50 border border-green-200 rounded text-sm text-green-800">
                <strong>Best Practice:</strong> Document all aspects of the
                system setup for future administrators.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Tab switching functionality
        const tabButtons = document.querySelectorAll(".tab-btn");
        const tabContents = document.querySelectorAll(".tab-content");

        tabButtons.forEach((button) => {
          button.addEventListener("click", () => {
            const tabId = button.id.replace("tab-", "");

            // Update active tab button
            tabButtons.forEach((btn) => {
              btn.classList.remove(
                "text-blue-600",
                "border-b-2",
                "border-blue-600"
              );
              btn.classList.add("text-gray-500");
            });
            button.classList.remove("text-gray-500");
            button.classList.add(
              "text-blue-600",
              "border-b-2",
              "border-blue-600"
            );

            // Show active tab content
            tabContents.forEach((content) => {
              content.classList.remove("active");
            });
            document.getElementById(`content-${tabId}`).classList.add("active");
          });
        });

        // Certificate preview update
        const updateCertificateBtn =
          document.getElementById("update-certificate");
        if (updateCertificateBtn) {
          updateCertificateBtn.addEventListener("click", () => {
            document.getElementById("cert-name").textContent =
              document.getElementById("input-name").value;
            document.getElementById("cert-class").textContent =
              document.getElementById("input-class").value;
            document.getElementById("cert-subject").textContent =
              document.getElementById("input-subject").value;
            document.getElementById("cert-grade").textContent =
              document.getElementById("input-grade").value;
            document.getElementById("cert-date").textContent =
              document.getElementById("input-date").value;
          });
        }

        // System configuration update
        const updateSystemBtn = document.getElementById("update-system");
        if (updateSystemBtn) {
          updateSystemBtn.addEventListener("click", () => {
            const minGrade = document.getElementById("min-grade").value;
            const categories = document.getElementById("categories").value;

            // Update spreadsheet conditional formatting formula
            const spreadsheetRows = document.querySelectorAll(
              "#spreadsheet-body tr"
            );
            spreadsheetRows.forEach((row) => {
              const gradeCell = row.cells[6];
              const statusCell = row.cells[7];
              const certLinkCell = row.cells[8];

              const grade = parseInt(gradeCell.textContent);
              if (grade >= parseInt(minGrade)) {
                statusCell.textContent = "Kirim Sertifikat";
                statusCell.classList.remove("bg-red-100");
                statusCell.classList.add("bg-green-100");
                certLinkCell.textContent = "View Certificate";
                certLinkCell.classList.add("text-blue-600", "underline");
              } else {
                statusCell.textContent = "Remedial";
                statusCell.classList.remove("bg-green-100");
                statusCell.classList.add("bg-red-100");
                certLinkCell.textContent = "-";
                certLinkCell.classList.remove("text-blue-600", "underline");
              }
            });

            // Update subject dropdown
            const subjectDropdown = document.getElementById("subject-dropdown");
            if (subjectDropdown) {
              subjectDropdown.innerHTML =
                '<option value="">Select subject/category</option>';
              categories.split(",").forEach((category) => {
                const trimmedCategory = category.trim();
                if (trimmedCategory) {
                  const option = document.createElement("option");
                  option.value = trimmedCategory;
                  option.textContent = trimmedCategory;
                  subjectDropdown.appendChild(option);
                }
              });
            }

            alert("System configuration updated successfully!");
          });
        }
      });
    </script>
    <script>
      (function () {
        function c() {
          var b = a.contentDocument || a.contentWindow.document;
          if (b) {
            var d = b.createElement("script");
            d.innerHTML =
              "window.__CF$cv$params={r:'94316882118bce65',t:'MTc0NzgwMjU1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
            b.getElementsByTagName("head")[0].appendChild(d);
          }
        }
        if (document.body) {
          var a = document.createElement("iframe");
          a.height = 1;
          a.width = 1;
          a.style.position = "absolute";
          a.style.top = 0;
          a.style.left = 0;
          a.style.border = "none";
          a.style.visibility = "hidden";
          document.body.appendChild(a);
          if ("loading" !== document.readyState) c();
          else if (window.addEventListener)
            document.addEventListener("DOMContentLoaded", c);
          else {
            var e = document.onreadystatechange || function () {};
            document.onreadystatechange = function (b) {
              e(b);
              "loading" !== document.readyState &&
                ((document.onreadystatechange = e), c());
            };
          }
        }
      })();
    </script>
  </body>
</html>
