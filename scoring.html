
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classroom Grade Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7fb;
        }
        .grade-input:focus {
            outline: 2px solid #4f46e5;
            background-color: #f0f9ff;
        }
        .student-row:hover {
            background-color: #f0f9ff;
        }
        .assignment-header {
            writing-mode: vertical-lr;
            transform: rotate(180deg);
            height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .pivot-cell {
            transition: all 0.2s;
        }
        .pivot-cell:hover {
            background-color: #e0f2fe;
        }
        .modal {
            transition: opacity 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="min-h-screen bg-gradient-to-br from-indigo-50 to-blue-50">
        <nav class="bg-white shadow-md">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                        </svg>
                        <span class="ml-2 text-xl font-semibold text-gray-800">EduGrade</span>
                    </div>
                    <div class="flex items-center">
                        <div class="flex items-center">
                            <img class="h-8 w-8 rounded-full object-cover" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%234f46e5'%3E%3Ccircle cx='12' cy='7' r='5'/%3E%3Cpath d='M17 14h.352a3 3 0 0 1 2.976 2.628l.391 3.124A2 2 0 0 1 18.734 22H5.266a2 2 0 0 1-1.985-2.248l.39-3.124A3 3 0 0 1 6.649 14H7'/%3E%3C/svg%3E" alt="User profile">
                            <span class="ml-2 text-gray-700 font-medium">Ms. Siti Nurhayati</span>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">Matematika Kelas X-A</h1>
                        <p class="text-gray-600">Semester Genap 2023/2024</p>
                    </div>
                    <div class="flex space-x-3">
                        <button id="exportBtn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Export Excel
                        </button>
                        <button id="addAssignmentBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                            </svg>
                            Tambah Tugas
                        </button>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex items-center space-x-4 mb-4">
                        <div class="relative">
                            <input type="text" id="searchInput" placeholder="Cari siswa..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 absolute left-3 top-2.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                        </div>
                        <select id="filterAssignment" class="border border-gray-300 rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            <option value="all">Semua Tugas</option>
                            <option value="tugas1">Tugas 1: Aljabar Linear</option>
                            <option value="tugas2">Tugas 2: Persamaan Kuadrat</option>
                            <option value="tugas3">Tugas 3: Trigonometri</option>
                            <option value="uts">UTS</option>
                            <option value="uas">UAS</option>
                        </select>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border border-gray-200">
                        <thead>
                            <tr class="bg-gray-50">
                                <th class="px-6 py-3 border-b border-r border-gray-200 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50 z-10" style="min-width: 200px;">
                                    Nama Siswa
                                </th>
                                <th class="border-b border-r border-gray-200 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <div class="assignment-header px-2">Tugas 1: Aljabar Linear</div>
                                </th>
                                
                                <th class="border-b border-r border-gray-200 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <div class="assignment-header px-2">Tugas 2: Persamaan Kuadrat</div>
                                </th>
                                <th class="border-b border-r border-gray-200 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <div class="assignment-header px-2">Tugas 3: Trigonometri</div>
                                </th>
                                <th class="border-b border-r border-gray-200 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <div class="assignment-header px-2">UTS</div>
                                </th>
                                <th class="border-b border-r border-gray-200 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <div class="assignment-header px-2">UAS</div>
                                </th>
                                <th class="border-b border-gray-200 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-indigo-50">
                                    <div class="assignment-header px-2">Nilai Akhir</div>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="gradeTable">
                            <!-- Student rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-bold text-gray-800 mb-4">Statistik Kelas</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold text-gray-700 mb-3">Rata-rata Nilai per Tugas</h3>
                        <div class="h-64 flex items-end justify-around">
                            <div class="flex flex-col items-center">
                                <div class="bg-blue-500 w-12 rounded-t-md" style="height: 120px;"></div>
                                <span class="mt-2 text-sm text-gray-600">Tugas 1</span>
                                <span class="font-medium">80</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div class="bg-blue-500 w-12 rounded-t-md" style="height: 150px;"></div>
                                <span class="mt-2 text-sm text-gray-600">Tugas 2</span>
                                <span class="font-medium">85</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div class="bg-blue-500 w-12 rounded-t-md" style="height: 100px;"></div>
                                <span class="mt-2 text-sm text-gray-600">Tugas 3</span>
                                <span class="font-medium">75</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div class="bg-blue-500 w-12 rounded-t-md" style="height: 130px;"></div>
                                <span class="mt-2 text-sm text-gray-600">UTS</span>
                                <span class="font-medium">82</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <div class="bg-blue-500 w-12 rounded-t-md" style="height: 140px;"></div>
                                <span class="mt-2 text-sm text-gray-600">UAS</span>
                                <span class="font-medium">83</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold text-gray-700 mb-3">Distribusi Nilai Akhir</h3>
                        <div class="h-64 flex items-center justify-center">
                            <div class="w-48 h-48 rounded-full bg-white flex items-center justify-center relative">
                                <svg viewBox="0 0 36 36" class="w-full h-full">
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#eee" stroke-width="3" />
                                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="#4f46e5" stroke-width="3" stroke-dasharray="75, 100" />
                                </svg>
                                <div class="absolute text-center">
                                    <div class="text-3xl font-bold text-indigo-600">75%</div>
                                    <div class="text-sm text-gray-500">Lulus</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Work Detail Modal -->
    <div id="studentWorkModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden modal">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800" id="modalTitle">Detail Tugas</h3>
                    <button id="closeModal" class="text-gray-400 hover:text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <div>
                            <h4 id="studentName" class="text-lg font-semibold text-gray-800">Ahmad Rizki</h4>
                            <p id="assignmentName" class="text-gray-600">Tugas 1: Aljabar Linear</p>
                        </div>
                        <div class="flex items-center">
                            <span class="text-gray-700 mr-2">Nilai:</span>
                            <input type="number" id="gradeInput" min="0" max="100" class="w-16 px-3 py-2 border border-gray-300 rounded-md text-center font-semibold text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500" value="85">
                            <button id="saveGrade" class="ml-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md">
                                Simpan
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center text-sm text-gray-500 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                        <span id="submissionDate">Dikumpulkan: 15 Maret 2024, 14:30</span>
                        <span class="mx-2">•</span>
                        <span id="submissionStatus" class="text-green-600 font-medium">Tepat Waktu</span>
                    </div>
                </div>

                <div class="border border-gray-200 rounded-lg p-4 mb-6 bg-gray-50">
                    <h5 class="font-medium text-gray-700 mb-2">Deskripsi Tugas:</h5>
                    <p id="assignmentDescription" class="text-gray-600">
                        Kerjakan soal-soal aljabar linear berikut dan jelaskan langkah penyelesaiannya dengan detail.
                        <br><br>
                        1. Selesaikan sistem persamaan linear berikut:
                        <br>
                        2x + 3y = 12
                        <br>
                        4x - y = 5
                        <br><br>
                        2. Tentukan nilai determinan dari matriks:
                        <br>
                        [3 1 2]
                        <br>
                        [4 2 1]
                        <br>
                        [2 5 3]
                    </p>
                </div>

                <div class="border border-gray-200 rounded-lg p-4 mb-6">
                    <h5 class="font-medium text-gray-700 mb-2">Jawaban Siswa:</h5>
                    <div id="studentAnswer" class="text-gray-600">
                        <p class="mb-4">
                            <strong>1. Penyelesaian sistem persamaan linear:</strong>
                            <br>
                            2x + 3y = 12 ... (1)
                            <br>
                            4x - y = 5 ... (2)
                            <br><br>
                            Dari persamaan (2):
                            <br>
                            -y = 5 - 4x
                            <br>
                            y = 4x - 5
                            <br><br>
                            Substitusi ke persamaan (1):
                            <br>
                            2x + 3(4x - 5) = 12
                            <br>
                            2x + 12x - 15 = 12
                            <br>
                            14x - 15 = 12
                            <br>
                            14x = 27
                            <br>
                            x = 27/14 = 1,93
                            <br><br>
                            Substitusi nilai x ke persamaan y = 4x - 5:
                            <br>
                            y = 4(1,93) - 5
                            <br>
                            y = 7,72 - 5
                            <br>
                            y = 2,72
                            <br><br>
                            Jadi, nilai x = 1,93 dan y = 2,72
                        </p>
                        <p>
                            <strong>2. Determinan matriks:</strong>
                            <br>
                            det([3 1 2; 4 2 1; 2 5 3])
                            <br>
                            = 3(2×3 - 1×5) - 1(4×3 - 1×2) + 2(4×5 - 2×2)
                            <br>
                            = 3(6 - 5) - 1(12 - 2) + 2(20 - 4)
                            <br>
                            = 3(1) - 1(10) + 2(16)
                            <br>
                            = 3 - 10 + 32
                            <br>
                            = 25
                            <br><br>
                            Jadi, nilai determinan matriks tersebut adalah 25.
                        </p>
                    </div>
                </div>

                <div class="border border-gray-200 rounded-lg p-4">
                    <h5 class="font-medium text-gray-700 mb-2">Komentar Guru:</h5>
                    <textarea id="teacherComment" class="w-full h-32 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Tambahkan komentar untuk siswa...">Jawaban untuk soal nomor 1 kurang tepat. Coba periksa kembali perhitungan Anda. Untuk soal nomor 2, jawaban sudah benar dengan langkah yang jelas. Secara keseluruhan cukup baik.</textarea>
                    <div class="flex justify-end mt-3">
                        <button id="saveComment" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md">
                            Simpan Komentar
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Assignment Modal -->
    <div id="addAssignmentModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden modal">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg">
            <div class="p-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold text-gray-800">Tambah Tugas Baru</h3>
                    <button id="closeAddAssignmentModal" class="text-gray-400 hover:text-gray-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <div class="mb-4">
                    <label for="assignmentTitle" class="block text-sm font-medium text-gray-700 mb-1">Judul Tugas</label>
                    <input type="text" id="assignmentTitle" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Contoh: Tugas 4: Statistika">
                </div>
                <div class="mb-4">
                    <label for="assignmentDesc" class="block text-sm font-medium text-gray-700 mb-1">Deskripsi</label>
                    <textarea id="assignmentDesc" class="w-full h-32 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Jelaskan detail tugas..."></textarea>
                </div>
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="dueDate" class="block text-sm font-medium text-gray-700 mb-1">Tenggat Waktu</label>
                        <input type="date" id="dueDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                    <div>
                        <label for="maxPoints" class="block text-sm font-medium text-gray-700 mb-1">Nilai Maksimum</label>
                        <input type="number" id="maxPoints" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" value="100">
                    </div>
                </div>
                <div class="flex justify-end mt-6">
                    <button id="cancelAddAssignment" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-md mr-2">
                        Batal
                    </button>
                    <button id="saveNewAssignment" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md">
                        Simpan Tugas
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data for students and grades
        const students = [
            { id: 1, name: "Ahmad Rizki", grades: { tugas1: 85, tugas2: 78, tugas3: 90, uts: 82, uas: 88 } },
            { id: 2, name: "Budi Santoso", grades: { tugas1: 75, tugas2: 82, tugas3: 68, uts: 78, uas: 80 } },
            { id: 3, name: "Citra Dewi", grades: { tugas1: 92, tugas2: 88, tugas3: 95, uts: 90, uas: 94 } },
            { id: 4, name: "Dian Purnama", grades: { tugas1: 65, tugas2: 70, tugas3: 75, uts: 68, uas: 72 } },
            { id: 5, name: "Eko Prasetyo", grades: { tugas1: 78, tugas2: 85, tugas3: 80, uts: 75, uas: 82 } },
            { id: 6, name: "Fitri Handayani", grades: { tugas1: 88, tugas2: 92, tugas3: 85, uts: 90, uas: 86 } },
            { id: 7, name: "Galih Pratama", grades: { tugas1: 72, tugas2: 68, tugas3: 75, uts: 70, uas: 74 } },
            { id: 8, name: "Hana Safira", grades: { tugas1: 95, tugas2: 90, tugas3: 92, uts: 88, uas: 90 } },
            { id: 9, name: "Irfan Hakim", grades: { tugas1: 82, tugas2: 85, tugas3: 78, uts: 80, uas: 84 } },
            { id: 10, name: "Jihan Aulia", grades: { tugas1: 90, tugas2: 88, tugas3: 92, uts: 86, uas: 90 } }
        ];

        // Assignment details
        const assignments = {
            tugas1: {
                title: "Tugas 1: Aljabar Linear",
                description: "Kerjakan soal-soal aljabar linear berikut dan jelaskan langkah penyelesaiannya dengan detail.\n\n1. Selesaikan sistem persamaan linear berikut:\n2x + 3y = 12\n4x - y = 5\n\n2. Tentukan nilai determinan dari matriks:\n[3 1 2]\n[4 2 1]\n[2 5 3]",
                dueDate: "15 Maret 2024, 14:30"
            },
            tugas2: {
                title: "Tugas 2: Persamaan Kuadrat",
                description: "Selesaikan persamaan kuadrat berikut dengan metode faktorisasi dan rumus kuadrat:\n\n1. x² - 5x + 6 = 0\n2. 2x² + 7x - 15 = 0\n3. 3x² - 12 = 0",
                dueDate: "29 Maret 2024, 14:30"
            },
            tugas3: {
                title: "Tugas 3: Trigonometri",
                description: "Buktikan identitas trigonometri berikut:\n\n1. sin²θ + cos²θ = 1\n2. tan²θ + 1 = sec²θ\n3. Tentukan nilai sin 30° + cos 60°",
                dueDate: "12 April 2024, 14:30"
            },
            uts: {
                title: "UTS",
                description: "Ujian Tengah Semester mencakup materi Aljabar Linear, Persamaan Kuadrat, dan Trigonometri.",
                dueDate: "5 Mei 2024, 10:00"
            },
            uas: {
                title: "UAS",
                description: "Ujian Akhir Semester mencakup seluruh materi yang telah dipelajari selama semester.",
                dueDate: "20 Juni 2024, 10:00"
            }
        };

        // Student answers (sample)
        const studentAnswers = {
            1: {
                tugas1: {
                    answer: "<strong>1. Penyelesaian sistem persamaan linear:</strong><br>2x + 3y = 12 ... (1)<br>4x - y = 5 ... (2)<br><br>Dari persamaan (2):<br>-y = 5 - 4x<br>y = 4x - 5<br><br>Substitusi ke persamaan (1):<br>2x + 3(4x - 5) = 12<br>2x + 12x - 15 = 12<br>14x - 15 = 12<br>14x = 27<br>x = 27/14 = 1,93<br><br>Substitusi nilai x ke persamaan y = 4x - 5:<br>y = 4(1,93) - 5<br>y = 7,72 - 5<br>y = 2,72<br><br>Jadi, nilai x = 1,93 dan y = 2,72<br><br><strong>2. Determinan matriks:</strong><br>det([3 1 2; 4 2 1; 2 5 3])<br>= 3(2×3 - 1×5) - 1(4×3 - 1×2) + 2(4×5 - 2×2)<br>= 3(6 - 5) - 1(12 - 2) + 2(20 - 4)<br>= 3(1) - 1(10) + 2(16)<br>= 3 - 10 + 32<br>= 25<br><br>Jadi, nilai determinan matriks tersebut adalah 25.",
                    comment: "Jawaban untuk soal nomor 1 kurang tepat. Coba periksa kembali perhitungan Anda. Untuk soal nomor 2, jawaban sudah benar dengan langkah yang jelas. Secara keseluruhan cukup baik.",
                    status: "Tepat Waktu"
                }
            }
        };

        // Function to calculate final grade
        function calculateFinalGrade(grades) {
            const weights = {
                tugas1: 0.15,
                tugas2: 0.15,
                tugas3: 0.15,
                uts: 0.25,
                uas: 0.3
            };
            
            let finalGrade = 0;
            for (const [assignment, grade] of Object.entries(grades)) {
                finalGrade += grade * weights[assignment];
            }
            
            return Math.round(finalGrade);
        }

        // Populate the grade table
        function populateGradeTable() {
            const tableBody = document.getElementById('gradeTable');
            tableBody.innerHTML = '';
            
            students.forEach(student => {
                const row = document.createElement('tr');
                row.className = 'student-row';
                
                // Student name cell (sticky)
                const nameCell = document.createElement('td');
                nameCell.className = 'px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-b border-r border-gray-200 sticky left-0 bg-white';
                nameCell.textContent = student.name;
                row.appendChild(nameCell);
                
                // Grade cells
                for (const [assignment, grade] of Object.entries(student.grades)) {
                    const gradeCell = document.createElement('td');
                    gradeCell.className = 'border-b border-r border-gray-200 text-center py-4 pivot-cell';
                    gradeCell.setAttribute('data-student-id', student.id);
                    gradeCell.setAttribute('data-assignment', assignment);
                    
                    // Create grade display with color coding
                    const gradeDisplay = document.createElement('div');
                    gradeDisplay.className = 'text-sm font-medium mx-auto w-12 py-1 rounded-md';
                    
                    if (grade >= 90) {
                        gradeDisplay.classList.add('bg-green-100', 'text-green-800');
                    } else if (grade >= 80) {
                        gradeDisplay.classList.add('bg-blue-100', 'text-blue-800');
                    } else if (grade >= 70) {
                        gradeDisplay.classList.add('bg-yellow-100', 'text-yellow-800');
                    } else {
                        gradeDisplay.classList.add('bg-red-100', 'text-red-800');
                    }
                    
                    gradeDisplay.textContent = grade;
                    gradeCell.appendChild(gradeDisplay);
                    
                    // Add click event to show student work
                    gradeCell.addEventListener('click', () => {
                        showStudentWorkModal(student, assignment);
                    });
                    
                    row.appendChild(gradeCell);
                }
                
                // Final grade cell
                const finalGrade = calculateFinalGrade(student.grades);
                const finalGradeCell = document.createElement('td');
                finalGradeCell.className = 'border-b border-gray-200 text-center py-4 bg-indigo-50';
                
                const finalGradeDisplay = document.createElement('div');
                finalGradeDisplay.className = 'text-sm font-bold mx-auto w-12 py-1 rounded-md';
                
                if (finalGrade >= 90) {
                    finalGradeDisplay.classList.add('bg-green-200', 'text-green-800');
                } else if (finalGrade >= 80) {
                    finalGradeDisplay.classList.add('bg-blue-200', 'text-blue-800');
                } else if (finalGrade >= 70) {
                    finalGradeDisplay.classList.add('bg-yellow-200', 'text-yellow-800');
                } else {
                    finalGradeDisplay.classList.add('bg-red-200', 'text-red-800');
                }
                
                finalGradeDisplay.textContent = finalGrade;
                finalGradeCell.appendChild(finalGradeDisplay);
                row.appendChild(finalGradeCell);
                
                tableBody.appendChild(row);
            });
        }

        // Show student work modal
        function showStudentWorkModal(student, assignmentKey) {
            const modal = document.getElementById('studentWorkModal');
            const studentNameEl = document.getElementById('studentName');
            const assignmentNameEl = document.getElementById('assignmentName');
            const submissionDateEl = document.getElementById('submissionDate');
            const submissionStatusEl = document.getElementById('submissionStatus');
            const assignmentDescriptionEl = document.getElementById('assignmentDescription');
            const studentAnswerEl = document.getElementById('studentAnswer');
            const teacherCommentEl = document.getElementById('teacherComment');
            const gradeInputEl = document.getElementById('gradeInput');
            const modalTitleEl = document.getElementById('modalTitle');
            
            // Set modal title
            modalTitleEl.textContent = 'Detail Tugas';
            
            // Set student name and assignment name
            studentNameEl.textContent = student.name;
            assignmentNameEl.textContent = assignments[assignmentKey].title;
            
            // Set submission date and status
            submissionDateEl.textContent = `Dikumpulkan: ${assignments[assignmentKey].dueDate}`;
            
            // Default status if not found
            let status = "Tepat Waktu";
            let statusClass = "text-green-600";
            
            // Check if we have specific status for this student/assignment
            if (studentAnswers[student.id] && 
                studentAnswers[student.id][assignmentKey] && 
                studentAnswers[student.id][assignmentKey].status) {
                status = studentAnswers[student.id][assignmentKey].status;
                
                if (status !== "Tepat Waktu") {
                    statusClass = "text-amber-600";
                }
            }
            
            submissionStatusEl.textContent = status;
            submissionStatusEl.className = `${statusClass} font-medium`;
            
            // Set assignment description
            assignmentDescriptionEl.innerHTML = assignments[assignmentKey].description.replace(/\n/g, '<br>');
            
            // Set student answer if available
            if (studentAnswers[student.id] && studentAnswers[student.id][assignmentKey]) {
                studentAnswerEl.innerHTML = studentAnswers[student.id][assignmentKey].answer;
                teacherCommentEl.value = studentAnswers[student.id][assignmentKey].comment || '';
            } else {
                studentAnswerEl.innerHTML = '<em>Tidak ada jawaban yang tersedia.</em>';
                teacherCommentEl.value = '';
            }
            
            // Set current grade
            gradeInputEl.value = student.grades[assignmentKey];
            
            // Set up save grade button
            const saveGradeBtn = document.getElementById('saveGrade');
            saveGradeBtn.onclick = () => {
                const newGrade = parseInt(gradeInputEl.value);
                if (newGrade >= 0 && newGrade <= 100) {
                    student.grades[assignmentKey] = newGrade;
                    populateGradeTable();
                    
                    // Show success notification
                    alert('Nilai berhasil disimpan!');
                } else {
                    alert('Nilai harus antara 0-100');
                }
            };
            
            // Set up save comment button
            const saveCommentBtn = document.getElementById('saveComment');
            saveCommentBtn.onclick = () => {
                // Create structure if it doesn't exist
                if (!studentAnswers[student.id]) {
                    studentAnswers[student.id] = {};
                }
                
                if (!studentAnswers[student.id][assignmentKey]) {
                    studentAnswers[student.id][assignmentKey] = {
                        answer: studentAnswerEl.innerHTML,
                        status: status
                    };
                }
                
                // Save the comment
                studentAnswers[student.id][assignmentKey].comment = teacherCommentEl.value;
                
                // Show success notification
                alert('Komentar berhasil disimpan!');
            };
            
            // Show the modal
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Close student work modal
        document.getElementById('closeModal').addEventListener('click', () => {
            const modal = document.getElementById('studentWorkModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        });

        // Add Assignment Modal
        document.getElementById('addAssignmentBtn').addEventListener('click', () => {
            const modal = document.getElementById('addAssignmentModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        });

        // Close Add Assignment Modal
        document.getElementById('closeAddAssignmentModal').addEventListener('click', () => {
            const modal = document.getElementById('addAssignmentModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        });

        document.getElementById('cancelAddAssignment').addEventListener('click', () => {
            const modal = document.getElementById('addAssignmentModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        });

        // Save New Assignment
        document.getElementById('saveNewAssignment').addEventListener('click', () => {
            const title = document.getElementById('assignmentTitle').value;
            const description = document.getElementById('assignmentDesc').value;
            const dueDate = document.getElementById('dueDate').value;
            
            if (!title || !description || !dueDate) {
                alert('Mohon lengkapi semua field!');
                return;
            }
            
            // In a real app, this would save to a database
            alert('Tugas baru berhasil ditambahkan!');
            
            // Close modal
            const modal = document.getElementById('addAssignmentModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        });

        // Export to Excel
        document.getElementById('exportBtn').addEventListener('click', () => {
            alert('File Excel berhasil diunduh!');
        });

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#gradeTable tr');
            
            rows.forEach(row => {
                const studentName = row.querySelector('td:first-child').textContent.toLowerCase();
                if (studentName.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        // Filter by assignment
        document.getElementById('filterAssignment').addEventListener('change', (e) => {
            const selectedAssignment = e.target.value;
            const headers = document.querySelectorAll('thead th');
            const cells = document.querySelectorAll('#gradeTable td');
            
            if (selectedAssignment === 'all') {
                // Show all columns
                headers.forEach((header, index) => {
                    if (index > 0) header.style.display = '';
                });
                
                cells.forEach((cell, index) => {
                    if (index % 7 !== 0) cell.style.display = '';
                });
            } else {
                // Show only selected assignment column and final grade
                headers.forEach((header, index) => {
                    if (index === 0 || header.querySelector('div').textContent.toLowerCase().includes(selectedAssignment) || index === 6) {
                        header.style.display = '';
                    } else {
                        header.style.display = 'none';
                    }
                });
                
                // For each row
                const rows = document.querySelectorAll('#gradeTable tr');
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    cells.forEach((cell, index) => {
                        const assignmentAttr = cell.getAttribute('data-assignment');
                        if (index === 0 || assignmentAttr === selectedAssignment || index === 6) {
                            cell.style.display = '';
                        } else {
                            cell.style.display = 'none';
                        }
                    });
                });
            }
        });

        // Initialize the table
        document.addEventListener('DOMContentLoaded', () => {
            populateGradeTable();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'93cf208e140dfddf',t:'MTc0Njc3MjAwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>